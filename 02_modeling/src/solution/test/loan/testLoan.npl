package loan

use loanRequest.LoanRequest

const borrower = 'Bob';
const lender = 'Alice';

@test
function verifyRepaidAmount(test: Test) -> {
    var loanRequest = LoanRequest[borrower, lender]("Dog hospice", 1000, 60);
    loanRequest.contribute[lender]("Alice", 1000);
    loanRequest.loan.getOrFail().repayLoan[borrower](200);
    test.assertEquals(loanRequest.loan.getOrFail().repaidAmount, 200, "The repaid amount is correct");
};

@test
function verifyObligationToRepay(test: Test) -> {
    var loanRequest = LoanRequest[borrower, lender]("Dog hospice", 1000, 60);
    loanRequest.contribute[lender]("Alice", 1000);
    loanRequest.loan.getOrFail().repayLoan[borrower](200);
    test.setTime(now().plus(days(loanRequest.loanRepaymentTimeline_Days + 1)));
    test.assertEquals(loanRequest.loan.getOrFail().activeState().getOrFail(), Loan.States.overdue, "The loan is overdue as expected");
};